💼 學員與教育訓練整合管理系統 (CRM System for Training Management)

  🚀 專案簡介
  
      本專案利用寒假期間開發，旨在解決父親在保險/教育訓練業務中，長期面臨的 **「學員資料散落在不同 Excel 檔」**、**「難以追蹤個人上課歷史」** 以及 **「軟體序號管理混亂」** 等痛點。
      不同於市面上龐大的 CRM 系統，我使用 **Python** 與 **Streamlit** 構建了一個輕量級、針對特定業務邏輯客製化的 Web App。系統採用 **SQLite** 作為核心資料庫，實現了學員資料的集中化管理（Single Source of Truth），讓父親能透過手機隨時隨地查詢學員的詳細履歷，而繁雜的資料整併工作則由後台自動化處理。
  
  🛠️ 核心技術亮點
  
      1. 穩健的資料更新邏輯 (Idempotent Upsert Logic)
        為了處理重複上傳 Excel 造成的資料汙染問題，我在 `db_logic.py` 中設計了嚴謹的 Upsert (Update or Insert) 機制：
          唯一識別碼 (Unique Key)：鎖定「手機號碼」作為學員的唯一識別，自動過濾掉格式不一的輸入（如 `0912-345-678` 與 `0912345678` 自動統一）。
          智慧更新：系統會先檢查手機號碼是否存在。若存在，則更新基本資料（如職稱、地址變更）；若不存在，則自動生成新的 `student_id`。
          防重複寫入：在寫入課程或軟體紀錄時，會比對「學員ID + 課程名稱/軟體序號」，確保同一筆交易不會因重複上傳而被計算兩次。
      2. 本地維護、雲端唯讀的混合架構 (Hybrid Deployment Strategy)
        在開發過程中，為了在「資料持久性」與「雲端便利性」取得平衡，我設計了一套獨特的工作流：
          Admin 端 (Local)：利用 SQLite (`crm.db`) 在本地進行高效、穩定的資料清洗與寫入，避開了 API 連線不穩與配額限制的問題。
          User 端 (Streamlit Cloud)：透過 Git 版本控制或後台同步機制，將最新的資料庫部署至雲端，提供一個「唯讀但極速」的查詢介面給終端使用者（父親）。
      3. 彈性的 ETL 資料清洗管道 
        針對原始 Excel 欄位命名不統一的問題（例如有時叫「手機」、有時叫「電話號碼」），在 `upload_excel.py` 中實作了容錯讀取邏輯：
          動態欄位映射：使用 `row.get('姓名') or row.get('Name')` 等方式處理多種欄位命名可能。
          髒資料過濾：自動剔除缺少關鍵欄位（Name/Phone）的無效列，並將 `NaN` 或 `None` 值標準化處理，防止資料庫報錯。

  📦 功能說明
  
      📊 儀表板 (Dashboard)：首頁即時顯示「總學員數」、「累計上課人次」與「軟體銷售筆數」，量化業務成果。
      🔍 學員查詢：
        支援姓名模糊搜尋（Fuzzy Search）。
        單一頁面整合顯示：基本個資、公司職稱、所有上課歷史紀錄、軟體購買與序號紀錄。
      🔐 管理員後台：
        具備簡易密碼驗證機制，防止誤觸。
        批次匯入：支援「課程紀錄」與「軟體購買」兩種格式的 Excel 批次上傳。
        資料庫同步：提供介面讓管理員上傳最新的本地資料庫覆蓋雲端版本。
  
  💻 執行環境
  
      語言：Python 3.10+
      框架：Streamlit (Web UI), Pandas (Data Processing)
      資料庫：SQLite3
      部署：Streamlit Cloud
  
  📂 目錄結構
  

      Project_Root/
      ├── Home.py                 # 應用程式入口與儀表板 (Dashboard)
      ├── crm.db                  # SQLite 資料庫文件 (核心資料存儲)
      ├── pages/
      │   ├── 學員檔案查詢.py       # 提供給父親使用的查詢介面
      │   └── 管理員後台.py         # 需密碼驗證的資料匯入與同步後台
      ├── utils/
      │   ├── db_logic.py         # 資料庫 CRUD 核心邏輯 (Connect, Upsert, Select)
      │   ├── upload_excel.py     # Excel 檔案解析與清洗邏輯 (ETL)
      │   └── init_db.py          # 資料庫初始化腳本 (Table Schema 定義)
      └── requirements.txt        # 專案依賴套件
  
  🎓 專案實務省思：從技術堆疊到使用者體驗
  
      1. 用戶角色的分離設計 (Separation of Concerns)
        在需求訪談中，我發現父親對於「上傳檔案」感到恐懼，因為不熟悉程式相關內容，擔心弄壞資料。
        解決方案：我將系統切分為「查詢端」與「管理端」。查詢端極度簡化，只有搜尋框；管理端則加上密碼鎖並由我負責維護。這讓我學會了「配合使用者的數位能力設計 UI」，而不僅僅是堆砌功能。
  
      2. AI 協作開發的進階應用
        在這個專案中，我更熟練地運用 AI 來輔助開發：
          SQL Schema 設計：利用 AI 快速生成符合 `3NF` (正規化) 的資料庫關聯表結構 (Students -> Courses/Softwares)。
          錯誤排查：在遇到 Streamlit Cloud 的 `Ephemeral Storage`（暫存儲存）特性導致資料重置問題時，透過與 AI 的討論釐清了雲端運作原理，並制定了「本地更新 -> 推送雲端」的解決方案。

---

*本專案為2026寒假自主學習成果，透過解決真實世界的業務需求，深化了對 Python 資料處理與 Web 應用開發的理解。*
