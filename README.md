💼 學員與教育訓練整合管理系統 (CRM System for Training Management)  
(https://pmdatabase-pvl77urya6hs4djp7ztc7h.streamlit.app/)
  
  🚀 專案簡介
      本專案利用寒假期間開發，旨在解決父親在保險/教育訓練業務中，長期面臨的 「學員資料散落在不同 Excel 檔」、「難以追蹤個人上課歷史」 以及 「軟體序號管理混亂」等問題。
      不同於市面上龐大的 CRM 系統，我使用 Python 與 Streamlit 構建了一個輕量級、針對特定業務邏輯客製化的 Web App。系統採用 SQLite 作為核心資料庫，實現了學員資料的集中化管理（Single Source of Truth），讓父親能透過手機隨時隨地查詢學員的詳細履歷，而繁雜的資料整併工作則由後台自動化處理。
  
  🛠️ 核心技術亮點
  
      1. 多層次遞進式身分識別 (Multi-tiered Identity Matching)
        為了解決 Excel 資料缺失手機號碼時造成的「重複建立」或「資料錯位」問題，我在 db_logic.py 中設計了嚴謹的遞進式比對機制：
          手機優先：鎖定「手機號碼」作為首要識別碼，自動統一格式（如補開頭 0、去除 .0 或連字號）。
          遞進比對：若無手機資料，系統會依序嘗試 「姓名 + Email」、「姓名 + 住址」、「姓名 + 公司」 組合。這確保了跨年度、不同來源的資料能精確歸併至同一學員檔案。
          SQL IS 運算符處理 NULL：在防止重複匯入紀錄時，使用 SQL IS 取代 =，解決了資料庫中 NULL = NULL 判定為 False 的經典陷阱。
      2. 隱私優先的部署策略 (Privacy-First Security Strategy)
        針對學員個資（手機、Email）的安全性，我捨棄了將資料庫直接存放在 GitHub 的做法，設計了 「結構上雲、數據本地」 的同步流程：
          防止個資洩漏：GitHub 倉庫僅存放空資料庫結構及程式碼。
          管理員同步機制：管理員需登入後台，透過私下傳輸的 crm.db 檔案進行「手動同步」上傳至 Streamlit Cloud，確保敏感個資不經過公開的版本控制系統。
          金鑰保護：後台整合了身分驗證，僅持有特定金鑰的用戶可存取匯入與同步功能。
      3. 高穩定性的 ETL 資料清洗管道
        針對原始 Excel 欄位命名混亂與格式汙染問題，在 upload_excel.py 中實作了強化的清洗邏輯：
          預先全局清洗：在迭代數據前完成 DataFrame 格式轉換（如標題去除 _x000d_、換行符號，處理 NaN 為 None），徹底根除因索引偏移導致的「張冠李戴」錯誤。
          動態欄位映射：靈活處理如「手機」、「手機號碼」、「電話號碼」等不同命名習慣，並自動過濾無效列。

  📦 功能說明
  
      📊 儀表板 (Dashboard)：首頁即時顯示「總學員數」、「累計上課人次」與「軟體銷售筆數」，量化業務成果。
      🔍 學員查詢：
        支援姓名模糊搜尋（Fuzzy Search）。
        單一頁面整合顯示：基本個資、公司職稱、所有上課歷史紀錄、軟體購買與序號紀錄。
      🔐 管理員後台：
        具備簡易密碼驗證機制，防止誤觸。
        批次匯入：支援「課程紀錄」與「軟體購買」兩種格式的 Excel 批次上傳，上傳 Excel 後可選分頁，並具備前 10 筆資料預覽功能。
        同步備份：支援雲端資料庫覆蓋更新與下載本地備份。
  
  💻 執行環境
  
      語言：Python 3.13.7
      框架：Streamlit (Web UI), Pandas (Data Processing)
      資料庫：SQLite3
      部署：Streamlit Cloud
  
  📂 目錄結構
  
      Project_Root/
      ├── Home.py                 # 應用程式入口與儀表板 (Dashboard)
      ├── pages/
      │   ├── 學員檔案查詢.py       # 提供給父親使用的查詢介面
      │   └── 管理員後台.py         # 需密碼驗證的資料匯入與同步後台
      ├── utils/
      │   ├── db_logic.py         # 資料庫 CRUD 核心邏輯 (Connect, Upsert, Select)
      │   ├── upload_excel.py     # Excel 檔案解析與清洗邏輯 (ETL)
      │   └── init_db.py          # 資料庫初始化腳本 (Table Schema 定義)
      └── requirements.txt        # 專案依賴套件
  
  🎓 專案實務省思：從技術堆疊到使用者體驗
  
      1. 數據韌性的設計：對抗「混亂資料」的邏輯設計
        在實作過程中，我深刻體會到「真實世界的資料永遠是髒的」。處理一萬多筆資料時，我遇到了合併儲存格、手機格式跑掉（如 .0）、甚至是關鍵欄位缺失等問題。
        省思： 系統的強大不在於華麗的介面，而在於「容錯能力」。我學會了在 Python 迴圈外進行預先清洗，並設計了手機、Email、住址等多層次的遞進配對邏輯。這讓我明白：好的邏輯設計，是為了在最壞的資料狀況下，依然能導向最準確的結果。
  
      2. 資料識別的深度：解決 SQL NULL 與重複寫入的陷阱
        開發中最讓我頭痛的是「重複匯入」的問題。我原以為單純的比對就能解決，卻踩進了 NULL = NULL 在 SQL 中判定為 False 的坑，導致資料不斷重複生成。
        省思： 這次經驗讓我掌握了更深層的 SQL 運算（如 IS 運算符的應用）。我體認到，確保資料的 「等冪性 (Idempotency)」——即無論操作多少次，系統狀態都應保持一致——是建構專業 CRM 系統不可或缺的基石。

      3. 安全與便利的權衡：資料主權 (Data Sovereignty) 的考量
        當專案要從本地推向雲端時，我面臨了「資料隱私」與「存取便利」的兩難。若將包含個資的資料庫存放在 GitHub，等同於讓學員資料直接地暴露於公眾。
        省思： 為了保護隱私，我設計了 「結構上雲、數據本地」 的同步策略。這雖然增加了開發難度（需要撰寫同步與上傳頁面），但這種「Security by Design」的思維，是資管人在處理真實個資時必須具備的職業道德與架構思維。
        
---

*本專案為2026寒假自主學習成果，透過解決真實世界的業務需求，深化了對 Python 資料處理、 SQLite實作 與 Web 應用開發的理解。*
